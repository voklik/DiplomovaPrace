using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class SelectRandomPoint : Node
{
    //Tøída, která vybere náhodný terén a zvíøe se k nìmu vydá.
    //Tento uzel existuje, aby byl na scénì nìjaký pohyb, pokud zvíøata nepotøebují øešit své potøeby
    private readonly List<Stav> prerusitelneStavy = new List<Stav> { Stav.Nothing };
    private readonly List<Stav> neprerusitelneStavy = new List<Stav> { };
    private Stav stavProNod = Stav.GoRandom;
    private float timetoCatch = 0;
    private float timetoCatchLimit = 15.0f;
    public SelectRandomPoint(Animal ai)
    {
        this.character = ai;
    }


    /// <summary>
    /// Zpracování uzlu - Charakter si vybere náhodný terén a vydá se k nìmu. Pokud to dlouho trvá, tak si vybyre další
    /// </summary>
    /// <returns></returns>
    public override NodeState Evaluate()
    {
        if ((character.IsOneOfState(prerusitelneStavy) && !character.IsOneOfState(neprerusitelneStavy)) || character.GetStav == stavProNod)
        {
            timetoCatch += Time.deltaTime;
            if (timetoCatch >= timetoCatchLimit)
            { character.SetRandomPointTarget(); character.Vypis("zmìna"); timetoCatch = 0; }

            if (character.GetRandomPointTarget() != null)
            {
                character.SetStav(stavProNod);
                return NodeState.SUCCESS;
                //??asi nic?? //TODO SMAZAT
            }
            else
            {
                if (character.SetRandomPointTarget() != null)
                {
                    if (character.GetStav != stavProNod)
                        character.SetStav(stavProNod);
                    timetoCatch = 0;
                    return NodeState.SUCCESS;
                }
            }
        }
        return NodeState.FAILURE;
    }
}
